# Linux-resource-monitoring-bot

Этот проект содержит Telegram-бота для мониторинга системных метрик удалённых машин по SSH и отправки отчётов в Telegram. Также в комплекте есть скрипт `setup_bot.sh` для установки необходимых библиотек и запуска бота с возможностью создания systemd-сервиса.

---

## Описание бота

Бот подключается по SSH к заданным машинам, собирает метрики CPU, RAM, Swap, Свободное место, Загрузку TCP памяти и количество соединений (concurrent connections), формирует отчёт и отправляет его в указанный Telegram-чат каждый час.

---

## Конфигурация

- В файле `bot.py` задайте:

  - `TOKEN` — токен вашего Telegram-бота.
  - `CHAT_ID` — ID чата или канала, куда будут отправляться отчёты.
  - `MACHINES` — список словарей с параметрами подключения к удалённым машинам (`name`, `host`, `user`, `password`).

---

## Использование скрипта установки `setup_bot.sh`

Скрипт автоматизирует создание виртуального окружения, установку зависимостей, запуск бота и (опционально) создание systemd-сервиса.

### Права
Для создания systemd-сервиса требуется запускать скрипт с пользователем, который имеет права на `sudo` для команд `systemctl` и записи в `/etc/systemd/system/`.

### Запуск скрипта

```bash
chmod +x setup_bot.sh
./setup_bot.sh [опции]
```
---
## Доступные флаги
| Флаг       | Описание |
|-----------|--------|
| -s | Запустить бота с созданием и запуском systemd-сервиса. Если не указан, бот запускается в интерактивном режиме без сервиса. |
| -d | Удалить скрипт setup_bot.sh после выполнения. |
| -n <name> | Задать имя systemd-сервиса (по умолчанию telegram-bot). |
| -h | Показать справку. |

---

## Примеры использования setup-bot.sh

### Запустить бота без systemd-сервиса (интерактивно):
```
./setup_bot.sh
```
### Запустить бота с созданием и запуском systemd-сервиса с именем по умолчанию:
```
./setup_bot.sh -s
```
### Запустить с сервисом и задать имя сервиса mybot:
```
./setup_bot.sh -s -n mybot
```
### Запустить с сервисом и удалить скрипт после установки:
```
./setup_bot.sh -s -d
```
### Показать справку:
```
./setup_bot.sh -h
```

---

## Запуск бота вручную

### Если вы не используете systemd-сервис, можно запустить бота вручную:

```
source ~/venv/bin/activate
python ~/bot.py
deactivate
```

---

## Требования
- Python 3.12+
- Пакеты Python: python-telegram-bot, paramiko
- SSH доступ к удалённым машинам с указанными логинами и паролями
- Для systemd-сервиса: права sudo для управления сервисами
